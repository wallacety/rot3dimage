/*
 rot3dimage v1.0.3
 (c) 2019.03 wallacety.
 github:https://github.com/wallacety/rot3dimage
 Blog:https://me.csdn.net/qq_29018891
 Emile:1506988056@qq.com
 License: M
*/
(function(){var a;var d={hrefArr:[],pageImgArr:[],cutIntoSlicesNumber:5,switchTime:"0.5",slicesTime:"1",lateralRotation:false,automatic:true,automaticTime:"3",changeButton:true};var h;var i;var b;var c;var g;var e=[];window.slice3dPoster=function(){};slice3dPoster.setLeftEle;slice3dPoster.setRightEle;function f(){function l(q){var r=new Array();for(var p=1;p<=q;p++){r.push(p)}this.list=r}l.prototype.setAttrBgi=function(){var r=this.list[this.list.length-1];var q=this.list[1];for(var p=0;p<e.length;p++){e[p].children[(o+1)%4].style.backgroundImage="url('"+d.pageImgArr[q-1]+"')";e[p].children[(o+3)%4].style.backgroundImage="url('"+d.pageImgArr[r-1]+"')"}};l.prototype.next=function(){var p=this.list.shift();this.list.push(p)};l.prototype.prev=function(){var p=this.list.pop();this.list.unshift(p)};l.prototype.sethref=function(q,p){q.href=p[n.list[0]-1]};var m=0;var o=0;var k=true;var n=new l(h);n.setAttrBgi();function j(q){if(!k){return false}k=false;if(q=="left"){m--;var r=-m*90;o--;if(o==-1){o=3}n.prev();n.sethref(c,d.hrefArr)}else{m++;var r=-m*90;o++;if(o==4){o=0}n.next();n.sethref(c,d.hrefArr)}for(var p=0;p<e.length;p++){if(d.lateralRotation){e[p].style.transform="rotateY("+r+"deg) "}else{e[p].style.transform="rotateX("+r+"deg) "}e[p].style.transitionDelay=p*+d.switchTime+"s"}}e[e.length-1].addEventListener("transitionend",function(){k=true;n.setAttrBgi()});(function(){if(d.automatic){var q=d.automaticTime*1000;var p=setInterval(function(){j("right")},q);a.addEventListener("mouseover",function(){clearInterval(p)});a.addEventListener("mouseout",function(){p=setInterval(function(){j("right")},q)})}}());slice3dPoster.setRightEle=function(p){p.style.zIndex="99";p.addEventListener("click",function(){j("right")})};slice3dPoster.setLeftEle=function(p){p.style.zIndex="99";p.addEventListener("click",function(){j("left")})};(function(){if(d.changeButton){var p=document.createElement("a");p.href="javascript:;";p.id="slice3dPoster-left";p.innerText="<";p.style.zIndex="99";a.appendChild(p);var q=document.createElement("a");q.href="javascript:;";q.id="slice3dPoster-right";q.innerText=">";p.style.zIndex="99";a.appendChild(q);window.slice3dPoster.setLeftEle(p);window.slice3dPoster.setRightEle(q)}}())}Element.prototype.slice3dPoster=function(j){a=this;a.className+=" Slice3dPoster";a.style.position="relative";for(var l in j){d[l]=j[l]}if(d.pageImgArr.length==0||d.hrefArr.length==0){console.log("错误！pageImgArr与hrefArr不能为空")}if(d.pageImgArr.length!=d.hrefArr.length){console.log("错误！pageImgArr与hrefArr一一对应")}a.style.borderWidth=0;d.cutIntoSlicesNumber=parseInt(d.cutIntoSlicesNumber);h=d.pageImgArr.length;i=Math.floor(a.offsetWidth/d.cutIntoSlicesNumber);b=a.offsetHeight;c=document.createElement("a");c.href=d.hrefArr[0];c.id="hrefAEle";a.appendChild(c);g=document.createElement("ul");a.appendChild(g);var n;for(var m=0;m<parseInt(d.cutIntoSlicesNumber);m++){n=document.createElement("li");n.style.width=i+"px";n.style.transition="all "+d.slicesTime+"s";n.innerHTML="<span></span><span></span><span></span><span></span>";n.children[0].style.background="url("+d.pageImgArr[0]+") no-repeat";if(d.lateralRotation){n.children[0].style.transform="translateZ("+i/2+"px)";n.children[1].style.transform="rotateY(90deg) translateZ("+i/2+"px)";n.children[2].style.transform="rotateY(180deg) translateZ("+i/2+"px)";n.children[3].style.transform="rotateY(270deg) translateZ("+i/2+"px)"}else{n.children[0].style.transform="translateZ("+b/2+"px)";n.children[1].style.transform="rotateX(90deg) translateZ("+b/2+"px)";n.children[2].style.transform="rotateX(180deg) translateZ("+b/2+"px)";n.children[3].style.transform="rotateX(270deg) translateZ("+b/2+"px)"}n.children[0].style.backgroundPositionX="-"+m*i+"PX";n.children[1].style.backgroundPositionX="-"+m*i+"PX";n.children[2].style.backgroundPositionX="-"+m*i+"PX";n.children[3].style.backgroundPositionX="-"+m*i+"PX";e.push(n);g.appendChild(n)}f()}}(window));